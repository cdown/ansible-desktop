# When failing over to Wi-Fi, the kernel learns the gateway's MAC. Upon
# replugging Ethernet, the kernel incorrectly tries to use the MAC it learned
# from the Wi-Fi on the wired port.
#
# This happens because by default, Linux shares one global ARP cache for all
# interfaces. An ARP reply received on the wifi interface pollutes this single
# cache, which is then incorrectly used by the internet interface.
#
# arp_filter changes the behaviour. It filters incoming ARP replies, ensuring
# the kernel only caches an entry if the source IP is reachable on the same
# interface that received the reply.
#
# This helps because it effectively creates per-interface ARP isolation. The
# ARP entry learned via wlan0 is no longer used by enp0s31f6, preventing the
# cache pollution and forcing the wired port to learn its own correct MAC
# address for the gateway.

net.ipv4.conf.all.arp_filter = 1
net.ipv4.conf.default.arp_filter = 1
