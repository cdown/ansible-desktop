# PipeWire/WirePlumber Bluetooth configuration
# Prefer LDAC codec for high-quality Bluetooth audio
# Auto-switch to Bluetooth when connected, fallback when disconnected

wireplumber.settings = {
  # Remember manual device selections across reboots
  node.restore-default-targets = true

  # Disable auto-switch to headset profile (keeps A2DP for music)
  bluetooth.autoswitch-to-headset-profile = false
}

monitor.bluez.properties = {
  # Prefer LDAC first, then fallback to AAC, then SBC
  bluez5.codecs = [ ldac aac sbc ]

  # Enable A2DP roles
  bluez5.roles = [ a2dp_sink a2dp_source ]
}

# Set LDAC to High Quality mode (990/909 kbps) and high priority
monitor.bluez.rules = [
  {
    matches = [
      {
        # Match all Bluetooth devices
        device.name = "~bluez_card.*"
      }
    ]
    actions = {
      update-props = {
        bluez5.a2dp.ldac.quality = "hq"
      }
    }
  }
  {
    matches = [
      {
        # Match Bluetooth output devices
        node.name = "~bluez_output.*"
      }
    ]
    actions = {
      update-props = {
        # High priority ensures auto-switch on connect
        priority.driver = 1200
        priority.session = 1200
      }
    }
  }
]
